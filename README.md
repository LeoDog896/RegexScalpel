# RegexScalpel

RegexScalpel is an automatic regex repair framework that adopts a localize-andfix strategy.

---

You can find more information in the paper "[RegexScalpel: Regular Expression Denial of Service (ReDoS) Defense by Localize-and-Fix](https://www.usenix.org/conference/usenixsecurity22/presentation/li-yeting)".

## Usage

This program runs under java8 environment.
You can find the main entrance to the program in the directory `/src/main/java/Main.java`.
The result of the regex fix will be generated by multiple rounds of fixes until one is generated without the ReDoS vulnerability.

**1. Interactively fixing a single regex**

You can use the following code in `Main.java` to do an interactive repair of a single regular

```java
SingleTester.Test(false, "a*a*b");
```

The first parameter is whether to enable random picking of repair results for each round. When you fill in `false`, the repair results for each round will be selected by the user interactively with the program on the command line.

The second parameter is the regex to be fixed, which can be replaced by whatever you want.

**2. Automatically fix a single regex**

Similar to the previous example, you can use the following code in `Main.java` to do an automatic repair of a single regular

```java
SingleTester.Test(true, "a*a*b");
```
**3. Automatic repair of regular expressions in datasets**

You can use the following code in `Main.java` to do an automatic repair of regular expressions in datasets

```java
DatasetTester.Test("data/input/CVE415-SOLA-DA.txt", "data/output/CVE415-SOLA-DA.txt");
```

The first parameter is the path of the input dataset.
The second parameter is the path of the output dataset.